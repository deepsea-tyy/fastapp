# AI è¾…åŠ©å¼€å‘æµç¨‹æŒ‡å—

> ğŸ“š **å¿«é€Ÿå¯¼èˆª**ï¼š[AI èƒ½åŠ›è¾¹ç•Œ](#ai-èƒ½åŠ›è¾¹ç•Œ) | [å¼€å‘æµç¨‹](#ai-å¼€å‘æµç¨‹) | [ä»£ç ç”Ÿæˆå™¨](#ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨) | [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
>
> ğŸ“– **ç›¸å…³æ–‡æ¡£**ï¼š[AIå¼€å‘æç¤ºè¯æ¨¡æ¿](./AIå¼€å‘æç¤ºè¯æ¨¡æ¿.md)

æœ¬æ–‡æ¡£è¯´æ˜å¦‚ä½•åˆ©ç”¨ AI åŸºäº FastApp å¼€å‘æ–‡æ¡£æ¥å®ç°å„ç§åŠŸèƒ½ã€‚

## âš¡ AI èƒ½åŠ›è¾¹ç•Œ

### âœ… AI å¯ä»¥åšä»€ä¹ˆ

| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| **é˜…è¯»å’Œåˆ†æ** | é˜…è¯»å’Œåˆ†æé¡¹ç›®æ–‡æ¡£ï¼Œç†è§£ä»£ç ç»“æ„å’Œå¼€å‘è§„èŒƒ |
| **ç”Ÿæˆä»£ç ** | ç”Ÿæˆä»£ç æ–‡ä»¶ï¼ˆPHPã€SQLã€é…ç½®æ–‡ä»¶ç­‰ï¼‰ |
| **ç”Ÿæˆå‘½ä»¤** | ç”Ÿæˆä»£ç ç”Ÿæˆå™¨å‘½ä»¤å’Œ SQL |
| **ç”Ÿæˆä¸šåŠ¡é€»è¾‘** | ç”Ÿæˆä¸šåŠ¡é€»è¾‘ä»£ç  |
| **ä¼˜åŒ–é‡æ„** | ä¼˜åŒ–å’Œé‡æ„ä»£ç  |
| **æ£€æŸ¥è§„èŒƒ** | æ£€æŸ¥ä»£ç è§„èŒƒå’Œè¯­æ³• |

### âŒ AI ä¸èƒ½åšä»€ä¹ˆ

| é™åˆ¶ | ç”¨æˆ·æ“ä½œ |
|------|---------|
| **ä¸èƒ½ç›´æ¥æ‰§è¡Œä»£ç ç”Ÿæˆå™¨å‘½ä»¤** | ç”¨æˆ·å¤åˆ¶å‘½ä»¤åˆ°ç»ˆç«¯æ‰§è¡Œ |
| **ä¸èƒ½ç›´æ¥æ‰§è¡Œæ•°æ®åº“ SQL** | ç”¨æˆ·åœ¨æ•°æ®åº“ä¸­æ‰§è¡Œ SQL |
| **ä¸èƒ½ç›´æ¥æ‰§è¡Œèœå• SQL** | ç”¨æˆ·æ‰§è¡Œèœå• SQL æ–‡ä»¶æˆ–ä½¿ç”¨ `--sql=true` |

### ğŸ¤ åä½œæ–¹å¼

**æ–¹å¼ä¸€ï¼ˆæ¨èï¼‰**ï¼šAI ç”Ÿæˆå‘½ä»¤ â†’ ç”¨æˆ·æ‰§è¡Œ â†’ AI éªŒè¯ â†’ AI æ‰§è¡Œåç»­æ“ä½œ

**æ–¹å¼äºŒï¼ˆå¦‚æœæ”¯æŒï¼‰**ï¼šç”¨æˆ·æˆæƒ â†’ AI æ‰§è¡Œ â†’ AI éªŒè¯ â†’ AI æ‰§è¡Œåç»­æ“ä½œ

---

## ğŸš€ AI å¼€å‘æµç¨‹

### ä¸€ã€ç†è§£é˜¶æ®µ

AI ä¼šè¯»å–å’Œåˆ†æé¡¹ç›®æ–‡æ¡£ï¼š

**æ ¸å¿ƒæ–‡æ¡£**ï¼ˆå¿…è¯»ï¼‰ï¼š
- `docs/README.md` - æ–‡æ¡£å¯¼èˆª
- `docs/é¡¹ç›®ç»“æ„.md` - é¡¹ç›®ç›®å½•ç»“æ„
- `docs/å¼€å‘è§„èŒƒ.md` - ä»£ç è§„èŒƒå’Œå¼€å‘æ¨¡å¼
- `docs/å¿«é€Ÿå¼€å§‹.md` - é¡¹ç›®å®‰è£…å’ŒåŸºç¡€é…ç½®

**åŠŸèƒ½æ–‡æ¡£**ï¼ˆæŒ‰éœ€é˜…è¯»ï¼‰ï¼š
- `docs/ä»£ç ç”Ÿæˆå™¨.md` - ä»£ç ç”Ÿæˆå™¨ä½¿ç”¨æ–¹å¼
- `docs/æ’ä»¶ç³»ç»Ÿä½¿ç”¨æŒ‡å—.md` - æ’ä»¶å¼€å‘æ–¹å¼
- `docs/æƒé™ç³»ç»Ÿä½¿ç”¨æ–‡æ¡£.md` - æƒé™ç³»ç»Ÿä½¿ç”¨æ–¹å¼

**ä»£ç ç»“æ„ç†è§£**ï¼š
- ä»£ç åˆ†å±‚æ¶æ„ï¼šController â†’ Service â†’ Repository â†’ Model
- å‘½åè§„èŒƒï¼šUserController.php â†’ UserService.php â†’ UserRepository.php â†’ User.php
- è·¯ç”±è§„èŒƒï¼š`/api/æ¨¡å—/åŠŸèƒ½` æˆ– `/admin/æ¨¡å—/åŠŸèƒ½`

**å¼€å‘æ¨¡å¼è¯†åˆ«**ï¼š
- **Admin æ¨¡å¼**ï¼šç»§æ‰¿ `App\Http\Admin\Controller\AbstractController`ï¼Œä½¿ç”¨ `PermissionMiddleware`
- **API æ¨¡å¼**ï¼šç»§æ‰¿ `App\Common\AbstractController`ï¼Œä½¿ç”¨ `TokenMiddleware`

### äºŒã€è§„åˆ’é˜¶æ®µ

#### éœ€æ±‚åˆ†æ

AI ä¼šæ ¹æ®éœ€æ±‚æè¿°ï¼š
1. ç†è§£ä¸šåŠ¡éœ€æ±‚ï¼ˆæå–æ ¸å¿ƒåŠŸèƒ½ç‚¹ã€è¯†åˆ«æ•°æ®æ¨¡å‹ï¼‰
2. æŠ€æœ¯é€‰å‹ï¼ˆAdmin/API æ¨¡å¼ã€æƒé™æ§åˆ¶ã€æ•°æ®æƒé™ï¼‰
3. ä¾èµ–åˆ†æï¼ˆéœ€è¦å“ªäº›æœåŠ¡ç±»ã€Repositoryã€Modelï¼‰

#### åˆ¤æ–­æ˜¯å¦éœ€è¦ä»£ç ç”Ÿæˆå™¨

**éœ€è¦ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨**ï¼š
- âœ… éœ€è¦åˆ›å»ºæ–°çš„æ•°æ®åº“è¡¨ + å®Œæ•´ CRUD
- âœ… éœ€è¦å‰ç«¯é¡µé¢ï¼ˆAdmin æ¨¡å¼ï¼‰
- âœ… éœ€è¦æ ‡å‡†åŒ–çš„ä»£ç ç»“æ„

**ä¸éœ€è¦ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨**ï¼š
- âŒ æ‰©å±•å·²æœ‰åŠŸèƒ½
- âŒ å•ä¸ªæ¥å£å¼€å‘
- âŒ WebSocketã€å·¥å…·ç±»ç­‰éæ•°æ®åº“åŠŸèƒ½

**åˆ¤æ–­æµç¨‹**ï¼š
```
ç”¨æˆ·éœ€æ±‚ â†’ AI åˆ†æéœ€æ±‚ â†’ æ˜¯å¦éœ€è¦æ–°çš„æ•°æ®åº“è¡¨ï¼Ÿ
    â”œâ”€ æ˜¯ â†’ æ˜¯å¦éœ€è¦å®Œæ•´çš„ CRUDï¼Ÿ â†’ âœ… ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨
    â””â”€ å¦ â†’ æ˜¯å¦æ‰©å±•å·²æœ‰åŠŸèƒ½ï¼Ÿ â†’ âŒ ä¸ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨
```

#### å¼€å‘è®¡åˆ’åˆ¶å®š

**æƒ…å†µä¸€ï¼šéœ€è¦ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨**
1. æ•°æ®åº“è®¾è®¡ï¼šè®¾è®¡è¡¨ç»“æ„ï¼Œç”Ÿæˆ CREATE TABLE SQL
2. ä»£ç ç”Ÿæˆï¼šç”Ÿæˆä»£ç ç”Ÿæˆå™¨å‘½ä»¤ï¼Œç”¨æˆ·æ‰§è¡Œ
3. ä¸šåŠ¡é€»è¾‘å¼€å‘ï¼šåœ¨ Service/Repository/Controller å±‚æ·»åŠ ä¸šåŠ¡æ–¹æ³•
4. æƒé™é…ç½®ï¼šæ‰§è¡Œèœå• SQLï¼Œæ·»åŠ æ•°æ®æƒé™é€»è¾‘
5. ä»£ç ä¼˜åŒ–ï¼šæ£€æŸ¥ä»£ç è§„èŒƒï¼ŒéªŒè¯è¯­æ³•

**æƒ…å†µäºŒï¼šä¸éœ€è¦ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨**
1. ä»£ç åˆ†æï¼šåˆ†æç°æœ‰ä»£ç ç»“æ„
2. ä»£ç å¼€å‘ï¼šåœ¨ Service/Controller å±‚æ·»åŠ æ–¹æ³•
3. ä»£ç ä¼˜åŒ–ï¼šæ£€æŸ¥ä»£ç è§„èŒƒï¼ŒéªŒè¯è¯­æ³•

---

### ä¸‰ã€ä»£ç ç”Ÿæˆé˜¶æ®µ

#### æ•°æ®åº“è®¾è®¡

AI ä¼šæ ¹æ®éœ€æ±‚ç”Ÿæˆæ•°æ®åº“è¡¨ç»“æ„ï¼š

**å­—æ®µæ³¨é‡Šæ ¼å¼**ï¼š
- æ ¼å¼ï¼š`å­—æ®µè¯´æ˜[éªŒè¯è§„åˆ™,å…¶ä»–è§„åˆ™]`
- éªŒè¯è§„åˆ™ï¼š`required`ã€`optional`ã€`search`ã€`list`
- ç¤ºä¾‹ï¼š`äº§å“åç§°[required,search]`ã€`çŠ¶æ€ 0=ä¸‹æ¶,1=ä¸Šæ¶`

**è¡¨ç»“æ„éªŒè¯æ¸…å•**ï¼š
- âœ… è¡¨åä½¿ç”¨è›‡å½¢å‘½åï¼ˆå°å†™ï¼Œä¸‹åˆ’çº¿åˆ†éš”ï¼‰
- âœ… ä¸»é”®å‘½åä¸º `id`ï¼Œç±»å‹ä¸º `bigint(20) unsigned`
- âœ… åŒ…å« `created_at` å’Œ `updated_at` å­—æ®µ
- âœ… å¦‚éœ€è¦æ•°æ®æƒé™ï¼ŒåŒ…å« `created_by` å­—æ®µ
- âœ… å­—æ®µæ³¨é‡ŠåŒ…å«éªŒè¯è§„åˆ™

#### ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨

âš ï¸ **é‡è¦å‰æ**ï¼šä»£ç ç”Ÿæˆå™¨éœ€è¦å…ˆæ‰§è¡Œ SQL åˆ›å»ºè¡¨ï¼Œå› ä¸ºä»£ç ç”Ÿæˆå™¨ä¼šè¯»å–è¡¨ç»“æ„æ¥ç”Ÿæˆä»£ç ã€‚

**AI çš„åˆ¤æ–­å’Œæç¤ºæµç¨‹**ï¼š
1. AI åˆ¤æ–­æ˜¯å¦éœ€è¦ä»£ç ç”Ÿæˆå™¨
2. å¦‚æœéœ€è¦ï¼ŒAI ç”Ÿæˆ CREATE TABLE SQL å¹¶æç¤ºæ‰§è¡Œ
3. ç”¨æˆ·æ‰§è¡Œ SQL åï¼ŒAI ç”Ÿæˆä»£ç ç”Ÿæˆå™¨å‘½ä»¤
4. ç”¨æˆ·æ‰§è¡Œä»£ç ç”Ÿæˆå™¨åï¼ŒAI éªŒè¯ç”Ÿæˆçš„æ–‡ä»¶
5. AI è‡ªåŠ¨æ·»åŠ æ•°æ®æƒé™å’Œä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚éœ€è¦ï¼‰

**ä»£ç ç”Ÿæˆå™¨æ‰§è¡Œæµç¨‹**ï¼š
1. è¯»å–æ•°æ®åº“è¡¨ç»“æ„ï¼ˆè¡¨å¿…é¡»å·²å­˜åœ¨ï¼‰
2. ç”Ÿæˆ JSON é…ç½®æ–‡ä»¶ï¼ˆ`runtime/json/{tableName}.json`ï¼‰
3. ç”Ÿæˆåç«¯ä»£ç ï¼ˆModelã€Requestã€Serviceã€Controllerã€Repositoryï¼‰
4. Admin æ¨¡å¼ï¼šç”Ÿæˆå‰ç«¯ä»£ç å’Œèœå• SQL æ–‡ä»¶
5. API æ¨¡å¼ï¼šåªç”Ÿæˆåç«¯ä»£ç 

**ç”Ÿæˆçš„æ–‡ä»¶ä½ç½®**ï¼š
- **åç«¯ä»£ç **ï¼š`app/Http/Admin|Api/Controller/{Module}/`ã€`app/Http/Admin|Api/Service/{Module}/` ç­‰
- **å‰ç«¯ä»£ç **ï¼ˆä»…Adminæ¨¡å¼ï¼‰ï¼š`web/src/modules/{module}/views/{tableName}/`
- **èœå•SQL**ï¼ˆä»…Adminæ¨¡å¼ï¼‰ï¼š`runtime/sql/{TableName}Menu.sql`

**æ³¨æ„äº‹é¡¹**ï¼š
- âš ï¸ ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆçš„ Service é»˜è®¤ä¸åŒ…å«æ•°æ®æƒé™ï¼Œéœ€è¦æ‰‹åŠ¨æ·»åŠ 
- èœå• SQL æ–‡ä»¶ä¸ä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œéœ€è¦æ‰‹åŠ¨æ‰§è¡Œæˆ–ä½¿ç”¨ `--sql=true`

#### è‡ªå®šä¹‰ä¸šåŠ¡é€»è¾‘

ä»£ç ç”Ÿæˆå™¨ç”ŸæˆåŸºç¡€ä»£ç åï¼ŒAI ä¼šæ ¹æ®éœ€æ±‚è¡¥å……ä¸šåŠ¡é€»è¾‘ï¼š

**Service å±‚å¢å¼º**ï¼šæ·»åŠ è‡ªå®šä¹‰ä¸šåŠ¡æ–¹æ³•

**Repository å±‚å¢å¼º**ï¼šæ·»åŠ è‡ªå®šä¹‰æŸ¥è¯¢æ–¹æ³•

**é‡è¦è¯´æ˜**ï¼š
- âš ï¸ ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆçš„ Service é»˜è®¤ä¸åŒ…å«æ•°æ®æƒé™é€»è¾‘
- âš ï¸ æ•°æ®æƒé™åº”è¯¥åœ¨ Service å±‚çš„æŸ¥è¯¢æ–¹æ³•ä¸­åº”ç”¨ï¼Œä¸æ˜¯ Repository å±‚
- âš ï¸ å¿…é¡»æ‰‹åŠ¨æ·»åŠ æ•°æ®æƒé™ï¼Œä»£ç ç”Ÿæˆå™¨ä¸ä¼šè‡ªåŠ¨æ·»åŠ 

**æ­£ç¡®çš„å®ç°æ–¹å¼**ï¼š
```php
public function page(array $params, int $page = 1, int $pageSize = 10): array
{
    $query = $this->repository->getQuery();
    
    // å…ˆåº”ç”¨æ•°æ®æƒé™
    DataScopeTool::applyUserDataScope(0, $query);
    
    // å†åº”ç”¨æœç´¢æ¡ä»¶å’Œæ’åº
    $query = $this->repository->perQuery($query, $params);
    
    // åˆ†é¡µæŸ¥è¯¢
    $result = $query->paginate(
        perPage: $pageSize,
        pageName: 'per_page',
        page: $page,
    );
    
    return $this->repository->handlePage($result);
}
```

**å¸¸è§é”™è¯¯**ï¼š
- âŒ åœ¨ Repository å±‚åº”ç”¨æ•°æ®æƒé™
- âŒ ä½¿ç”¨ `model()->newQuery()` è€Œä¸æ˜¯ `getQuery()`
- âŒ æ‰‹åŠ¨è°ƒç”¨ `handleSearch()` å’Œ `handleOrderBy()`ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ `perQuery()`
- âœ… åœ¨ Service å±‚ä½¿ç”¨ `getQuery()` å’Œ `perQuery()` æ–¹æ³•

---

### å››ã€ä»£ç éªŒè¯å’Œä¼˜åŒ–

#### ä»£ç éªŒè¯

**è¯­æ³•æ£€æŸ¥**ï¼š
- âœ… PHP è¯­æ³•æ­£ç¡®æ€§
- âœ… å‘½åç©ºé—´ã€ç±»åã€æ–¹æ³•åæ­£ç¡®
- âœ… å¯¼å…¥è¯­å¥å®Œæ•´

**è§„èŒƒæ£€æŸ¥**ï¼š
- âœ… å‘½åè§„èŒƒï¼ˆPascalCaseã€camelCaseï¼‰
- âœ… ä»£ç åˆ†å±‚ï¼ˆController â†’ Service â†’ Repository â†’ Modelï¼‰
- âœ… æ³¨è§£ä½¿ç”¨ï¼ˆSwaggerã€Permissionã€Middlewareï¼‰
- âœ… å¼‚å¸¸å¤„ç†å’Œæ³¨é‡Šè§„èŒƒ

**åŠŸèƒ½éªŒè¯**ï¼š
- âœ… æ‰€æœ‰å¿…éœ€çš„æ–¹æ³•éƒ½å·²å®ç°
- âœ… æƒé™æ³¨è§£å·²æ·»åŠ 
- âœ… æ•°æ®æƒé™å·²åº”ç”¨ï¼ˆå¦‚éœ€è¦ï¼‰
- âœ… å“åº”æ ¼å¼ç»Ÿä¸€

#### ä»£ç ä¼˜åŒ–

**æœ€ä½³å®è·µåº”ç”¨**ï¼š
- æƒé™æ§åˆ¶ï¼šä½¿ç”¨ `#[Permission(code: 'product:product:list')]` æ³¨è§£
- æ•°æ®æƒé™ï¼šåœ¨ Service å±‚ä½¿ç”¨ `DataScopeTool::applyUserDataScope(0, $query)`
- ç»Ÿä¸€å“åº”æ ¼å¼ï¼šä½¿ç”¨ `$this->success($data, 'æ“ä½œæˆåŠŸ')`
- å¼‚å¸¸å¤„ç†ï¼šæ·»åŠ  try-catch å’Œé”™è¯¯æ—¥å¿—

**æ€§èƒ½ä¼˜åŒ–**ï¼š
- âœ… é¿å… N+1 æŸ¥è¯¢é—®é¢˜
- âœ… ä½¿ç”¨ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢
- âœ… åˆç†ä½¿ç”¨ç¼“å­˜

---

## âœ¨ æœ€ä½³å®è·µ

1. **ä»æ–‡æ¡£å¼€å§‹**ï¼šå§‹ç»ˆè®© AI å…ˆç†è§£æ–‡æ¡£
2. **ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨**ï¼šä¼˜å…ˆä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”ŸæˆåŸºç¡€ä»£ç 
3. **å¼•ç”¨ç°æœ‰ä»£ç **ï¼šå‚è€ƒç°æœ‰ä»£ç ï¼Œè®© AI ç†è§£ä»£ç é£æ ¼
4. **åˆ†æ­¥éª¤éªŒè¯**ï¼šå°†å¤æ‚ä»»åŠ¡åˆ†è§£ä¸ºå¤šä¸ªæ­¥éª¤ï¼Œæ¯æ­¥éªŒè¯
5. **æ˜ç¡®è§„èŒƒ**ï¼šæ˜ç¡®æŒ‡å®šä½¿ç”¨ Admin æ¨¡å¼è¿˜æ˜¯ API æ¨¡å¼
6. **æ‰§è¡Œé¡ºåº**ï¼šå…ˆåˆ›å»ºè¡¨ï¼Œå†æ‰§è¡Œä»£ç ç”Ÿæˆå™¨
7. **æƒé™æ ¼å¼**ï¼šä½¿ç”¨æ­£ç¡®çš„æƒé™ä»£ç æ ¼å¼ï¼ˆ`module:table:action`ï¼‰
8. **æ•°æ®æƒé™**ï¼šåœ¨ Service å±‚åº”ç”¨æ•°æ®æƒé™ï¼Œä¸åœ¨ Repository å±‚
9. **èœå• SQL**ï¼šè®°å¾—æ‰§è¡Œèœå• SQL æ–‡ä»¶æˆ–ä½¿ç”¨ `--sql=true`
10. **éªŒè¯ä»£ç **ï¼šæ¯æ­¥å®ŒæˆåéªŒè¯ä»£ç è¯­æ³•å’Œè§„èŒƒ

---

## âš ï¸ å¸¸è§é™·é˜±é¿å…

| é™·é˜± | é”™è¯¯åšæ³• | æ­£ç¡®åšæ³• |
|------|---------|---------|
| æ’ä»¶ç±»å‹å‚æ•° | `--type=mixed` | `--type=mix`ï¼ˆä½¿ç”¨æšä¸¾é”®åï¼‰ |
| è¡¨ç»“æ„æ ¼å¼ | å­—æ®µæ³¨é‡Šæ ¼å¼ä¸æ­£ç¡® | ä½¿ç”¨ `[required,search]` æ ¼å¼ |
| æ¨¡å—åå¤§å°å†™ | `--module=Product` | `--module=product`ï¼ˆå°å†™ï¼‰ |
| æ•°æ®æƒé™åº”ç”¨ | åœ¨ Repository å±‚åº”ç”¨ | åœ¨ Service å±‚åº”ç”¨ |
| æ•°æ®æƒé™å®ç° | ä½¿ç”¨ `model()->newQuery()` | ä½¿ç”¨ `getQuery()` |
| æœç´¢æ¡ä»¶å¤„ç† | æ‰‹åŠ¨è°ƒç”¨ `handleSearch()` | ä½¿ç”¨ `perQuery()` ç»Ÿä¸€å¤„ç† |
| æƒé™ä»£ç æ ¼å¼ | `product.product.list` | `product:product:list` |
| å“åº”æ ¼å¼ | ç›´æ¥è¿”å›æ•°ç»„ | ä½¿ç”¨ `$this->success($data, $message)` |

