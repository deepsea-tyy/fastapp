# 项目结构说明

## 项目根目录

```
fastapp/
├── bin/              # 命令行入口（hyperf.php）
├── app/              # 应用代码
├── config/           # 配置文件
├── databases/        # 数据库文件（migrations、seeders）
├── plugin/           # 插件目录
├── runtime/          # 运行时文件（日志、缓存等）
├── storage/          # 存储目录（languages、swagger、uploads、view）
└── web/              # 前端代码
```

## app目录结构

```
app/
├── Command/          # 命令行工具
│   ├── Generator/   # 代码生成器（CRUD、迁移、Seeder、SQL导入）
│   └── Plugin/      # 插件管理（创建、安装、卸载）
├── Common/           # 公共组件库
│   ├── AbstractController.php  # 控制器基类
│   ├── Result.php              # 统一响应格式
│   ├── IService.php            # 服务基类
│   ├── Tools.php               # 工具类
│   ├── Event/                  # 事件系统
│   ├── Excel/                  # Excel导入导出
│   ├── Jwt/                    # JWT认证系统
│   ├── Middleware/             # 中间件
│   ├── Request/                # 请求验证器
│   ├── Service/                # 公共服务（验证码、IP地理位置）
│   ├── Subscriber/             # 事件订阅者
│   ├── Swagger/                # API文档注解
│   └── Upload/                 # 文件上传
├── Exception/        # 异常处理（Handler）
├── Http/             # HTTP层
│   ├── CurrentUser.php         # 当前用户信息
│   ├── PassportService.php     # 通行证服务
│   ├── Admin/        # 后台管理API（Controller、Service、Middleware、Request、Vo）
│   ├── Api/          # 前端API（Controller、Middleware、Request）
│   └── Common/       # HTTP公共组件（Traits）
├── Listener/         # 事件监听器
├── Model/            # 数据模型（Casts、Enums、Permission、User、UserProfile等）
├── Repository/       # 数据仓库层（IRepository、Permission、Logstash、Traits）
├── Schema/           # 数据库模式（Swagger Schema定义）
├── TestCommand.php   # 测试命令
└── Websocket/        # WebSocket相关（WsController、WsMessageAbstract等）
```

## config配置系统

```
config/
├── config.php        # 基础配置
├── container.php     # 容器配置
├── routes.php        # 路由配置（框架保留，实际使用注解路由）
└── autoload/        # 自动加载配置
    ├── annotations.php  # 注解配置
    ├── databases.php    # 数据库配置
    ├── jwt.php          # JWT配置
    ├── logger.php       # 日志配置
    ├── middlewares.php  # 中间件配置
    ├── redis.php        # Redis配置
    ├── swagger.php      # Swagger配置
    └── ...             # 其他配置文件
```

## 代码分层架构

```
Controller → Service → Repository → Model
    ↓           ↓          ↓         ↓
   HTTP      业务逻辑    数据操作   数据模型
```

### 各层职责

| 层级 | 职责 |
|------|------|
| **Controller** | 处理HTTP请求和响应、参数验证、调用Service层 |
| **Service** | 业务逻辑处理、事务管理、业务规则验证 |
| **Repository** | 数据访问逻辑、查询构建、数据缓存处理 |
| **Model** | 数据模型定义、数据关系映射、数据验证规则 |

## 命名规范

### 文件命名
- 控制器：`UserController.php`
- 服务类：`UserService.php`
- 仓库类：`UserRepository.php`
- 模型类：`User.php`
- 请求类：`UserRequest.php`

### 目录命名
- 使用PascalCase（大驼峰）命名
- 保持与业务模块一致
- 避免过深的目录嵌套

## 模块化设计

建议按业务功能划分模块：

```
app/Http/Admin/
├── Controller/
│   ├── User/        # 用户管理模块
│   ├── Product/     # 产品管理模块
│   └── Order/        # 订单管理模块
└── Service/
    ├── User/
    ├── Product/
    └── Order/
```

**优势**：代码组织清晰、功能隔离明确、团队协作高效、维护扩展方便
