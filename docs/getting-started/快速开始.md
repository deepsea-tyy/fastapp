# 快速开始指南

## 1. 环境准备

### 系统要求

- PHP >= 8.1
- Swoole >= 5.0
- MySQL >= 5.7
- Redis >= 3.0
- Composer >= 2.0

### 安装步骤

```bash
# 克隆项目
git clone [repository-url]
cd fastapp

# 安装依赖
composer install

# 复制环境配置
cp .env.example .env

# 编辑环境配置
vim .env
```

## 2. 环境配置

### 基础环境变量配置

编辑 `.env` 文件，配置以下基本信息：

```env
# 应用配置
APP_NAME=FastApp
APP_DEBUG=false

# 数据库配置
DB_DRIVER=mysql
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=fastapp
DB_USERNAME=root
DB_PASSWORD=your_password

# JWT配置（生成密钥：base64_encode(random_bytes(32))）
JWT_SECRET=your-jwt-secret-key-base64-encoded
JWT_TTL=3600

# Redis配置
REDIS_HOST=127.0.0.1
REDIS_PORT=6379
```

> 💡 **详细配置说明**：完整的配置选项和说明请参考 [配置说明文档](../development/配置说明.md)

## 3. 数据库配置

### 创建数据库

```bash
mysql -u root -p -e "CREATE DATABASE fastapp CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"
```

### 运行数据库迁移

```bash
# 运行所有迁移
php bin/hyperf.php migrate

# 回滚迁移
php bin/hyperf.php migrate:rollback
```

### 数据填充

```bash
# 运行数据填充
php bin/hyperf.php db:seed
```

## 4. 开发新模块

### 步骤1：创建数据库表

```sql
CREATE TABLE `users` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `username` varchar(255) NOT NULL COMMENT '用户名',
  `email` varchar(255) NOT NULL COMMENT '邮箱',
  `password` varchar(255) NOT NULL COMMENT '密码',
  `status` tinyint(1) NOT NULL DEFAULT '1' COMMENT '状态[1:正常,0:禁用]',
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `users_email_unique` (`email`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户表';
```

### 步骤2：使用代码生成器

```bash
# 生成CRUD代码（包含前后端代码）
php bin/hyperf.php ds:crud --table=users --module=admin

# 生成纯API代码（只生成后端PHP代码）
php bin/hyperf.php ds:crud --table=users --module=api --target=api
```

> 💡 **详细使用说明**：代码生成器的完整功能和使用方法请参考 [代码生成器文档](../features/代码生成器.md)

### 步骤3：启动服务测试

```bash
# 启动开发服务器
php bin/hyperf.php start

# 或使用守护进程模式
php bin/hyperf.php server:start -d
```

## 5. 常用命令

```bash
# 启动开发服务器
php bin/hyperf.php start

# 数据库迁移
php bin/hyperf.php migrate
php bin/hyperf.php migrate:rollback

# 清除缓存
php bin/hyperf.php cache:clear

# 查看路由列表
php bin/hyperf.php route:list
```

> 💡 **更多命令**：完整的命令列表和使用说明请参考框架文档或使用 `php bin/hyperf.php` 查看帮助

## 6. 第一个API开发示例

### 步骤1：创建请求验证器

```php
// app/Http/Api/Request/ProductRequest.php
namespace App\Http\Api\Request;

use Hyperf\Validation\Request\FormRequest;

class ProductRequest extends FormRequest
{
    protected array $scenes = [
        'create' => ['name', 'price', 'category_id'],
        'update' => ['name', 'price'],
    ];

    public function rules(): array
    {
        return [
            'name' => 'required|string|max:100',
            'price' => 'required|numeric|min:0',
            'category_id' => 'required|integer|exists:categories,id',
        ];
    }
}
```

### 步骤2：创建服务类

```php
// app/Http/Admin/Service/ProductService.php
namespace App\Http\Admin\Service;

use App\Common\IService;
use App\Repository\ProductRepository;

class ProductService extends IService
{
    public function __construct(protected ProductRepository $repository) {}
    
    // 继承IService的方法可直接使用，如需自定义可重写
}
```

### 步骤3：创建控制器

```php
// app/Http/Api/Controller/ProductController.php
namespace App\Http\Api\Controller;

use App\Common\AbstractController;
use App\Http\Api\Request\ProductRequest;
use App\Http\Admin\Service\ProductService;
use Hyperf\Swagger\Annotation\Get;
use Hyperf\Swagger\Annotation\Post;

class ProductController extends AbstractController
{
    public function __construct(
        private readonly ProductService $service
    ) {}

    #[Get(path: '/api/products', summary: '产品列表', tags: ['产品接口'])]
    public function index(ProductRequest $request)
    {
        return $this->success($this->service->getList($request->validated()));
    }

    #[Post(path: '/api/products', summary: '创建产品', tags: ['产品接口'])]
    public function store(ProductRequest $request)
    {
        $product = $this->service->create($request->scene('create')->validated());
        return $this->success($product, '创建成功');
    }
}
```

### 步骤4：测试API

```bash
# 启动服务
php bin/hyperf.php start

# 测试API
curl -X GET http://localhost:9501/api/products
curl -X POST http://localhost:9501/api/products \
  -H "Content-Type: application/json" \
  -d '{"name":"测试产品","price":99.9,"category_id":1}'
```

> 💡 **注意**：框架使用 Swagger 注解配置路由，无需在 `routes.php` 中配置。

## 7. 下一步

### 学习更多内容

- 📖 [项目结构](./项目结构.md) - 了解项目目录结构和代码分层
- 📖 [开发规范](../development/开发规范.md) - 学习代码规范和最佳实践
- 📖 [核心功能概览](../features/核心功能.md) - 了解框架提供的核心功能
- 📖 [配置说明](../development/配置说明.md) - 详细配置选项说明
- 📖 [权限系统使用文档](../permission/权限系统使用文档.md) - 权限系统使用指南

更多文档请查看 [文档导航](../README.md)
